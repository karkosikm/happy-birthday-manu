<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday, Manu ‚ù§Ô∏è</title>
  <meta name="description" content="A birthday surprise ‚Äî five months of us." />

  <!-- Perf: preconnect to Vimeo domains -->
  <link rel="preconnect" href="https://player.vimeo.com" crossorigin>
  <link rel="preconnect" href="https://i.vimeocdn.com" crossorigin>
  <link rel="preconnect" href="https://f.vimeocdn.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#fff1f5; --bg2:#f3e8ff; --ink:#2a2a2a; --accent:#a21caf;
      --paper:#ffffff; --bezel:#0f172a22;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0; font-family: Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 800px at 10% 10%, #ffffffcc, transparent),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      display:flex; align-items:center; justify-content:center;
      min-height:100vh; padding:18px; overflow-x:hidden;
      position: relative;
    }

    /* Falling confetti/balloons/hearts -> BEHIND the phone/video */
    .floaty{
      position: fixed; inset:0; pointer-events:none; overflow:hidden;
      z-index: 0; /* behind everything */
    }
    .piece{
      position:absolute;
      font-size:1.6rem;
      will-change: transform, opacity;
      animation: fall linear infinite;
      opacity:0.95;
    }
    @keyframes fall{
      0%   { transform: translateY(-120vh) rotate(0deg);   opacity:1; }
      100% { transform: translateY(110vh)  rotate(360deg); opacity:0.85; }
    }

    .wrap{
      width:100%; max-width:1000px; text-align:center; position:relative;
      padding-top:36px; z-index:2;
    }

    h1{
      font-family:'Dancing Script',cursive; font-weight:700; color:var(--accent);
      font-size:clamp(1.8rem, 5.2vw, 3rem);
      margin:0 0 12px; line-height:1.25; text-shadow:0 1px 0 #fff8; padding-top:4px;
    }
    .subtitle{
      margin:0 0 24px; opacity:.9; font-size:clamp(1.1rem, 3.6vw, 1.55rem);
      font-family:'Dancing Script',cursive; color:#444; line-height:1.3;
    }

    /* Phone-style frame */
    .phone{
      display:inline-block; background:var(--paper); padding:14px;
      border-radius:34px; box-shadow: 0 18px 50px var(--bezel);
      position: relative; z-index: 3; /* above floaty */
    }
    .screen{
      position:relative; aspect-ratio:9/16; width:min(100vw - 48px, 420px);
      border-radius:24px; overflow:hidden; background:#000;
    }
    .screen iframe{
      position:absolute; inset:0; width:100%; height:100%; border:0;
    }

    @media (min-width:900px){
      .screen{
        height:82dvh; /* a touch smaller than before */
        width: calc(82dvh * 9 / 16);
        max-width: 560px; /* smaller desktop cap to encourage lower-bitrate stream */
      }
    }

    .note{ margin-top:28px; font-size:clamp(.95rem, 3vw, 1.05rem); opacity:.85; }
    footer{ margin-top:30px; font-size:.9rem; opacity:.65; }

    @media (max-width:430px){
      body{padding:12px}
      .subtitle{margin:0 0 20px;}
      .note{margin-top:24px;}
    }
    @media (min-width:992px){
      body{ align-items:flex-start; padding-top:56px; }
      .wrap{ padding-top:28px; }
    }

    @media (prefers-reduced-motion: reduce){
      .piece{ animation: none !important; }
    }

    /* Unmute overlay (kept, but now it's above only the phone area if you want to keep using it) */
    .unmute{
      position:absolute; inset:auto 0 12px 0; margin:auto;
      width:fit-content; padding:10px 14px;
      background:rgba(255,255,255,.9);
      border-radius:999px; box-shadow:0 6px 20px rgba(0,0,0,.15);
      font-weight:600; font-size:0.95rem; color:#111; cursor:pointer; user-select:none;
      display:flex; align-items:center; gap:8px;
      z-index:4;
      transition: transform .15s ease, opacity .15s ease;
    }
    .unmute:hover{ transform: translateY(-1px); }
    .unmute.hidden{ opacity:0; pointer-events:none; }
  </style>
</head>
<body>
  <!-- Falling decorations (behind the phone) -->
  <div class="floaty" id="floaty"></div>

  <main class="wrap" role="main">
    <h1>Happy Birthday, Manu ‚ù§Ô∏è</h1>
    <p class="subtitle">Five Months Of Us, Mi Amor ‚ú®</p>

    <section class="phone" aria-label="Vertical birthday video keepsake">
      <div class="screen">
        <iframe
          id="vimeo"
          src="https://player.vimeo.com/video/1131444835?badge=0&amp;autopause=0&amp;title=0&amp;byline=0&amp;portrait=0&amp;loop=1&amp;autoplay=1&amp;muted=1&amp;playsinline=1"
          allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share"
          referrerpolicy="strict-origin-when-cross-origin"
          title="Happy Birthday, Manu ‚ù§Ô∏è"
          loading="eager">
        </iframe>

        <!-- Tap to unmute -->
        <div class="unmute" id="unmuteBtn">üîä Tap for sound</div>
      </div>
    </section>

    <p class="note">Forever yours - M. ‚ù§Ô∏è</p>
    <footer>Made with love</footer>
  </main>

  <!-- Vimeo Player API -->
  <script src="https://player.vimeo.com/api/player.js"></script>
  <script>
    // Floating confetti, balloons & hearts (start mid-fall via negative delays)
    (function(){
      const root = document.getElementById('floaty');
      const symbols = ['üéâ','üéà','üíñ'];
      const isWide = window.matchMedia('(min-width:900px)').matches;
      const pieces = isWide ? 40 : 28;

      for(let i=0;i<pieces;i++){
        const d=document.createElement('div');
        d.className='piece';
        d.textContent=symbols[Math.floor(Math.random()*symbols.length)];
        d.style.left=Math.random()*100+'vw';
        const dur = 8 + Math.random()*8;              // 8‚Äì16s fall
        d.style.fontSize=(16+Math.random()*18)+'px';
        d.style.animationDuration = dur + 's';
        d.style.animationDelay = (-Math.random()*dur) + 's'; // negative = already falling
        root.appendChild(d);
      }
    })();

    // Vimeo: autoplay muted (required by browsers), then unmute on first tap
    (function(){
      const iframe = document.getElementById('vimeo');
      const player = new Vimeo.Player(iframe);
      const btn = document.getElementById('unmuteBtn');

      player.play().catch(()=>{/* ignore */});

      function unmute() {
        player.setMuted(false).then(()=>{
          player.setVolume(1);
          btn.classList.add('hidden');
        }).catch(()=>{/* some browsers need direct iframe tap */});
      }
      btn.addEventListener('click', unmute, {passive:true});

      iframe.addEventListener('load', ()=>{
        player.getMuted().then(m => { if(!m) btn.classList.add('hidden'); });
      });
      player.on('volumechange', ({volume})=>{
        player.getMuted().then(m => { if(!m && volume>0) btn.classList.add('hidden'); });
      });
    })();
  </script>
</body>
</html>
